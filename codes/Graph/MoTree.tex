\begin{lstlisting}
dfs u:
  push u
  iterate subtree
  push u
Let P = LCA(u, v) with St(u)<=St(v)
if (P == u) query[St(u), St(v)]
else query[Ed(u), St(v)], query[St(P), St(P)]
\end{lstlisting}
